#!/bin/bash
#this update-exploit-db script, it  will update  files repository from  exploit-db official repository on ./exploits
#Warnning it will only update, if you  installation are crashed it  will not work

git=$(which  git);
php=$(which  php);
exploit_dir=./exploits;
gitremote="https://github.com/offensive-security/exploit-database.git"

function update()
{
 cd "$exploit_dir/";
 if [[ "$( ${git} remote -v )" != *"${gitremote}"* ]]; then
    echo 'adding remote repo' "${gitremote}"
    git init >/dev/null
    git remote add origin "${gitremote}" 2>/dev/null
  fi
  
  # Make sure to prep checkout first
  git checkout -- .
  
  # Update from git
  git pull origin master
  
  # If conflicts, clean and try again
  if [[ "$?" -ne 0 ]]; then
    git clean -d -fx ""
    git pull origin master
  fi
  
  echo -e "Ok ! updated"
  exit 0


}

update;
